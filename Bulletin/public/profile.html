<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html" charset="utf-8" />
	<link rel="stylesheet" type="text/css" href="Semantic-UI-master/dist/semantic.min.css">
    <script src="Semantic-UI-master/dist/semantic.min.js"></script>
	<title>Profile page</title>
	<link href="images/favicon.ico" rel="SHORTCUT ICON">
</head>

<style type="text/css">
 body {
      //background: url('http://vignette1.wikia.nocookie.net/vsbattles/images/a/a3/Black-windows_542931.jpg/revision/latest?cb=20150317090032') fixed;
   background: url('https://raw.githubusercontent.com/lance91633/gitTest/master/nhu060E.jpg') fixed;
	}
    
p {
  font-family: 'Open Sans', sans-serif;
  font-size: 20px;
  color: #666;
}

.fileUpload {
    position: relative;
    overflow: hidden;
    margin: 10px;
}
.fileUpload input.upload {
    position: absolute;
    top: 0;
    right: 0;
    margin: 0;
    padding: 0;
    font-size: 20px;
    cursor: pointer;
    opacity: 0;
    filter: alpha(opacity=0);
}
</style>

<body>
	
	
	<script src="/socket.io/socket.io.js"></script>
    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
	<!--
	<div class="ui top attached button" onclick="location.href='index.html' " ><a href="index.html">Back to Main Page</a></div>      
	-->
	
	<div class = "ui   container segment" >
		<button class="ui violet basic  button" onclick='window.location.href = "http://luffy.ee.ncku.edu.tw:8011/user"'><a><i class="arrow left icon"></i>Back</a></button>
		<a></a>
		<button class="ui violet basic right floated button" onclick='window.location.href = "http://luffy.ee.ncku.edu.tw:8011/new_project_format"'><a><i class="write icon"></i> Add a new project</a></button>
		<div class="ui violet basic right floated button fileUpload" ><a><i class="file image outline icon"></i> Upload your profilephoto</a><input type="file" class="upload" id = 'profileP'/></div>
		<br></br>
		<br></br>
		<center>
			<div id = "profile_photo">
				<img id = "profile_img" class="ui  medium circular " src="images/profilePhoto.png" alt="" draggable="false"> 
				
			</div>
		</center>
		<br></br>
		<div class="ui grid">
			<div class = "four wide column" ></div>
			<div class = "eight wide column" >
				<table class="ui inverted grey  table">
				  <thead>
					
				  </thead>
				  <tbody>
					<tr>
					  <td>Account</td>
					  <td id = 'account'></td>
					</tr>
					<tr>
					  <td>Name</td>
					  <td id = 'name'></td> 
					</tr>
					<tr>
					  <td>Email</td>
					  <td id = 'email'></td> 
					</tr>
					<tr>
					  <td>Address</td>
					  <td id = 'addr'></td>  <!--2015/12/02-->
					</tr>
					<tr>
					  <td>Phone</td>
					  <td id = 'phone'></td> 
					</tr>
					<tr>
					  <td>Biography</td>
					  <td id = 'biography'></td> 
					</tr>
				  </tbody>
				  
				</table>
			</div>
			<div class = "four wide column" ></div>
		
		</div>
		
		<button type="button" class="ui positive button" id="d">Consume Record</button>
		<p id='record'>

		</p>
		
	</div>


	<script src="/socket.io/socket.io.js"></script>
	<script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
	<script>
		//$(profile_img).attr("src","data:image/png;base64,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")
		console.log($(profileP).val());
		var socket = io();
		var count = 0;
		if (localStorage.account != null){ //先登入才能看個資

			socket.emit('req_profile', localStorage.account);
			socket.on('res_profile', function(data){
				//data = user_data JSON
				if(data == false){
					alert('getting profile failed.');
					window.location.href = "http://luffy.ee.ncku.edu.tw:8011/";
				}
					
				else{
					//lay out to html
					$('#account').html(data.account);		
					$('#name').html(data.name);				
					$('#email').html(data.email);
					$('#addr').html(data.addr); //2015/12/02
					$('#phone').html(data.phone);
					$('#biography').html(data.biography);
				}
			});
			
			
		}
		
		else{
			alert('Please log in first.');
			window.location.href = "http://luffy.ee.ncku.edu.tw:8011/";
		}
		$('#d').click(function(){
		//test profilePhoto
		
		//test profilePhoto
		    if(count%2 == 0){
			    socket.emit('get_record',localStorage.getItem('account'));
				count++
			}
			else{
			    $('#record').html('');
				count++;
			}
		});
			  
		socket.on('res_record',function(data){
			var str = '';
			for(i=0;i<data.length;i++){
				//str += 'You spent '+data[i].price*data[i].count+'$ on '+data[i].count * 10+'% of the article " '+data[i].topic+' " at '+data[i].date+'<br>';
				str+='<tr><td>'+'<a href="http://luffy.ee.ncku.edu.tw:8011/read_it"'+' onclick='+"'"+'localStorage.setItem("'+'topic",'+'"'+data[i].topic+'"'+')'+"'"+'>'+data[i].topic+'</a>'+'</td><td>'
						+data[i].count * 10	+'</td><td>'
						+((data[i].price*data[i].count).toFixed(2))+'</td><td>'
						+data[i].date+'</td></tr>';
			}
			str = '<table class=\"ui celled table\"><thead><tr><th>Article</th><th>%</th><th>Money</th><th>Date</th></tr></thead><tbody>' + str + '</tbody></table>';
			$('#record').html(str);
			
		});	
		
	</script>
	
	<footer>
		<p>Copyright © 2015 <a href="index.html">Bulletin</a></p>
	</footer>
</body>
</html>